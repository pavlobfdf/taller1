<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Boleta · FE-10293</title>
  <style>
    body{font-family:Arial, sans-serif; background:#f6f7fb; margin:0; color:#0f172a}
    .wrap{max-width:900px; margin:24px auto; padding:0 16px}
    .card{background:#fff; border:1px solid #e5e7eb; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,.04); padding:14px}
    .row{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
    .btn{padding:10px 14px; border:0; border-radius:8px; cursor:pointer}
    .btn.blue{background:#2563eb; color:#fff}
    .btn.green{background:#16a34a; color:#fff}
    input[type=email]{flex:1; min-width:220px; padding:10px; border:1px solid #e5e7eb; border-radius:8px}
    ul{margin:0; padding-left:18px}
    .muted{color:#6b7280}

    .msg{display:none; margin-top:12px; padding:10px; border-radius:8px}
    .ok{background:#dcfce7; color:#065f46}
    .pend{background:#fef3c7; color:#92400e}
    .err{background:#fee2e2; color:#7f1d1d}
    .show{display:block}
  </style>
</head>
<body>
  <main class="wrap">
    <section class="card">
      <h3 style="margin:0 0 6px">Boleta Nº <span id="folio">12345678</span> — Pedido <span id="order">FE-10293</span></h3>
      <ul class="muted">
        <li>Bowl Proteico ×1 — <span id="p1">$6.990</span></li>
        <li>Snack Proteico ×1 — <span id="p2">$2.990</span></li>
      </ul>
      <div style="margin-top:6px"><strong>Total:</strong> <span id="total">$9.980</span> <span class="muted">(IVA incluido)</span></div>
    </section>

    <section class="card" style="margin-top:12px">
      <div class="row">
        <button id="pdf" class="btn blue">Descargar PDF</button>
        <button id="send" class="btn green">Reenviar por correo</button>
        <input id="email" type="email" value="ana@example.com" />
      </div>
      <div id="m-ok" class="msg ok">Boleta enviada al correo.</div>
      <div id="m-p" class="msg pend">Correo en cola · Se enviará en breve.</div>
      <div id="m-e" class="msg err">Error al enviar boleta · Intenta nuevamente.</div>
    </section>
  </main>

  <script>

    function clp(n){ return new Intl.NumberFormat('es-CL',{style:'currency',currency:'CLP',maximumFractionDigits:0}).format(n); }
    const bowl=6990, snack=2990; p1.textContent=clp(bowl); p2.textContent=clp(snack); total.textContent=clp(bowl+snack);


    document.getElementById('pdf').addEventListener('click', function(){
      alert('Descargando boleta PDF #' + document.getElementById('folio').textContent);
    });

    const m = { ok:document.getElementById('m-ok'), p:document.getElementById('m-p'), e:document.getElementById('m-e') };
    function show(x){ Object.values(m).forEach(el=>el.classList.remove('show')); x && x.classList.add('show'); }

    document.getElementById('send').addEventListener('click', function(){
      const email = document.getElementById('email').value.trim();
      if(!/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/.test(email)) { show(m.e); return; }


      const q = new URLSearchParams(location.search); const st = q.get('status');
      let result = st || (['ok','p','e'][Math.floor(Math.random()*3)]);
      if(result==='ok') show(m.ok); else if(result==='pend'||result==='p') show(m.p); else show(m.e);
    });
  </script>
</body>
</html>
